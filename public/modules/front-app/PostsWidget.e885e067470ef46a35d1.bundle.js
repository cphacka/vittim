(self.webpackChunk=self.webpackChunk||[]).push([[1197],{14665:function(e,t,n){"use strict";function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,{Z:function(){return s}})},46790:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var s,a=n(6610),r=n(5991),o=n(63349),i=n(10379),p=n(46070),l=n(77608),u=n(71614),c=n(76593),d=n(96156),m=n(92137),f=n(87757),g=n.n(f),h=n(67294),v=n(74374),y=n(81352),S=n(85009),O=n(71743),P=n(89878),b=n(32465),E=n(71893).ZP.div(s||(s=(0,b.Z)(["{\n  grid-template-columns: repeat(",", 1fr);\n  display: grid;    \n  ","\n"])),(function(e){return e.columnsCount}),(function(e){var t=e.posts_columns_gap,n=e.posts_rows_gap,s="";return t&&!Number(t)?s+="grid-column-gap:".concat(t,";"):Number(t)&&(s+="grid-column-gap:".concat(t,"px;")),n&&!Number(n)?s+="grid-row-gap:".concat(n,";"):Number(n)&&(s+="grid-row-gap:".concat(n,"px;")),s})),C=n(49825);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e){(0,i.Z)(d,e);var t,n,s,o,u=(s=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(s);if(o){var n=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,p.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),(t=u.call(this,e)).renderPost=function(e){var n=_.get(t.props.settings,"posts_transition_type",null),s=_.cloneDeep(t.props.data[e]||t.props.data),a=s.component||"",r=s.component||"";if(t.state.simpleTemplate&&!_.get(t.postsComponents,"".concat(t.state.simpleTemplateId,".").concat(e))){var o=S.default.cloneElement(t.state.simpleTemplate);o.setCardModel(new O.Z(s),e),a=h.createElement(o.componentClass,{element:o,ElementWrapper:P.default,children:o.children}),_.set(t.postsComponents,"".concat(t.state.simpleTemplateId,".").concat(e),a)}else _.get(t.postsComponents,"".concat(t.state.simpleTemplateId,".").concat(e))&&(a=_.get(t.postsComponents,"".concat(t.state.simpleTemplateId,".").concat(e)));if(t.state.hoverSimpleTemplate&&!_.get(t.postsComponents,"hover.".concat(t.state.hoverSimpleTemplateId,".").concat(e))){var i=S.default.cloneElement(t.state.hoverSimpleTemplate);i.setCardModel(new O.Z(s),e),r=h.createElement(i.componentClass,{element:i,ElementWrapper:P.default,children:i.children}),_.set(t.postsComponents,"hover.".concat(t.state.hoverSimpleTemplateId,".").concat(e),r)}else _.get(t.postsComponents,"hover.".concat(t.state.hoverSimpleTemplateId,".").concat(e))&&(r=_.get(t.postsComponents,"hover.".concat(t.state.hoverSimpleTemplateId,".").concat(e)));return h.createElement("div",{className:"altrp-post",key:s.id||s.altrpIndex},a,t.state.hoverSimpleTemplateId&&h.createElement("div",{className:"altrp-post altrp-post--hover altrp-post--hover--".concat(n)},r))},t.state={simpleTemplate:"",simpleTemplateId:null,currentPage:1},t.postsComponents={},t}return(0,r.Z)(d,[{key:"componentDidMount",value:(n=(0,m.Z)(g().mark((function e(){var t,n,s=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.settings,!(n=_.get(t,"posts_card_template"))){e.next=6;break}if(n){e.next=5;break}return e.abrupt("return");case 5:this.setState((function(e){return T(T({},e),{},{simpleTemplateId:n})}),(0,m.Z)(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.default.loadParsedTemplate(n);case 2:t=e.sent,s.setState((function(e){return T(T({},e),{},{simpleTemplate:t})}));case 4:case"end":return e.stop()}}),e)}))));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"shouldComponentUpdate",value:function(e,t){return!((0,c.isEditor)()&&this.props.settings===e.settings&&_.isEqual(this.state.simpleTemplate,t.simpleTemplate)&&_.isEqual(this.state.hoverSimpleTemplate,t.hoverSimpleTemplate)&&_.isEqual(this.state.simpleTemplateId,t.simpleTemplateId)&&this.state.hoverSimpleTemplateId!=t.hoverSimpleTemplateId&&_.isEqual(this.props.data,e.data)&&this.state.currentPage===t.currentPage)}},{key:"componentDidUpdate",value:(t=(0,m.Z)(g().mark((function e(t){var n,s,a,r,o,i,p=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.settings,s=this.state,a=s.simpleTemplateId,r=s.hoverSimpleTemplateId,o=_.get(n,"posts_card_template"),i=_.get(n,"posts_card_hover_template"),_.isEqual(t.data,this.props.data)||this.setState((function(e){return T(T({},e),{},{posts:p.props.data})})),this.props.data!==t.data&&(this.postsComponents={}),o===a){e.next=11;break}if(o){e.next=10;break}return this.setState((function(e){return T(T({},e),{},{simpleTemplateId:o,simpleTemplate:null})})),e.abrupt("return");case 10:this.setState((function(e){return T(T({},e),{},{simpleTemplateId:o})}),(0,m.Z)(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.default.loadParsedTemplate(o);case 2:t=e.sent,p.setState((function(e){return T(T({},e),{},{simpleTemplate:t})}));case 4:case"end":return e.stop()}}),e)}))));case 11:if(i===r){e.next=16;break}if(i){e.next=15;break}return this.setState((function(e){return T(T({},e),{},{hoverSimpleTemplateId:i,hoverSimpleTemplate:null})})),e.abrupt("return");case 15:this.setState((function(e){return T(T({},e),{},{hoverSimpleTemplateId:i})}),(0,m.Z)(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.default.loadParsedTemplate(i);case 2:t=e.sent,p.setState((function(e){return T(T({},e),{},{hoverSimpleTemplate:t})}));case 4:case"end":return e.stop()}}),e)}))));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getPageCount",value:function(){var e=this.props.data,t=Number((0,c.getResponsiveSetting)(this.props.settings,"posts_per_page"))||12;return t&&_.get(e,"length")?Math.ceil(e.length/t):1}},{key:"setPage",value:function(e){(e=Number(e))||(e=1),e<0&&(e=0),e>this.getPageCount()&&(e=this.getPageCount()),this.state.currentPage!==e&&this.setState((function(t){return T(T({},t),{},{currentPage:e})}))}},{key:"renderPagination",value:function(){var e=this,t=T({},this.props.settings),n=this.props.element,s=this.props.data;if(!s.length&&!(0,c.isEditor)())return null;if(n.getResponsiveSetting("posts_per_page")>=(null==s?void 0:s.length)||n.getResponsiveSetting("posts_per_page")<=0)return null;var a=n.getResponsiveSetting("prev_text","","Previous Page"),r=n.getResponsiveSetting("next_text","","Next Page"),o=(0,c.getResponsiveSetting)(this.props.settings,"posts_pagination_type")||"";if(o){var i=this.state.currentPage,p=this.getPageCount();if("pages"===o){t.hide_pagination_select=!0,t.hide_page_input=!0;var l={settings:t,pageCount:p,pageIndex:this.state.currentPage-1,nextPage:function(){e.setPage(e.state.currentPage+1)},previousPage:function(){e.setPage(e.state.currentPage-1)},gotoPage:function(t){e.setPage(t+1)},pageSize:this.props.element.getResponsiveSetting("posts_per_page"),widgetId:this.props.element.getId()};return h.createElement(C.Z,l)}return"prev_next"===o?h.createElement("div",{className:"altrp-pagination-pages"},h.createElement("button",{className:"altrp-pagination__previous "+(i<=1?"state-disabled":""),disabled:i<=1,onClick:function(){e.setPage(i-1)}},h.createElement("span",null,t.posts_prev_text||""),(0,c.renderAssetIcon)(t.prev_icon)),h.createElement("button",{className:"altrp-pagination__next "+(i===p?"state-disabled":""),disabled:i===p,onClick:function(){e.setPage(i+1)}},h.createElement("span",null,t.posts_next_text||""),(0,c.renderAssetIcon)(t.next_icon))):h.createElement("div",{className:"altrp-pagination"},!t.hide_pre_page_button&&h.createElement("button",{className:"altrp-pagination__previous",onClick:function(){return e.setPage(i-1)},disabled:i<=1},h.createElement("span",{dangerouslySetInnerHTML:{__html:a}}),(0,c.renderAssetIcon)(t.prev_icon)),!t.hide_pages_buttons_button&&h.createElement("div",{className:"altrp-pagination__count"},t.pageText),!t.hide_next_page_button&&h.createElement("button",{className:"altrp-pagination__next",onClick:function(){return e.setPage(i+1)},disabled:i===p},h.createElement("span",{dangerouslySetInnerHTML:{__html:r}}),(0,c.renderAssetIcon)(t.next_icon)))}return null}},{key:"render",value:function(){var e=this,t=this.state.currentPage,n=Number((0,c.getResponsiveSetting)(this.props.settings,"posts_per_page"))||12,s=this.props.data;!_.isArray(s)&&_.isObject(s)&&(s=[s]),_.isArray(s)||(s=[]);var a=0;n&&Number(n)&&n>0&&(t>1&&(a=(t-1)*n),s=s.slice(a,a+n));var r=Number((0,c.getResponsiveSetting)(this.props.settings,"posts_columns"))||1,o=(0,c.getResponsiveSetting)(this.props.settings,"posts_columns_gap")||"",i=(0,c.getResponsiveSetting)(this.props.settings,"posts_rows_gap")||"";return h.createElement(h.Fragment,null,h.createElement(E,{columnsCount:r,posts_columns_gap:o,posts_rows_gap:i,className:"altrp-posts"},s.map((function(t,n){return e.renderPost(a+n)}))),this.renderPagination())}}]),d}(h.Component),k=function(e){return"datasource"===e.settings.choose_datasource?((0,c.isEditor)()&&((e=T({},e)).settings=T({},e.settings),e.data=Array.from({length:3},(function(){return{}})),(0,c.setAltrpIndex)(e.data)),h.createElement(Z,e)):h.createElement(v.Z,e,h.createElement(Z,null))};var x=function(e){(0,i.Z)(d,e);var t,n,s=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,s=(0,l.Z)(t);if(n){var a=(0,l.Z)(this).constructor;e=Reflect.construct(s,arguments,a)}else e=s.apply(this,arguments);return(0,p.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),(t=s.call(this,e)).state={settings:e.element.getSettings()},e.element.component=(0,o.Z)(t),window.elementDecorator&&window.elementDecorator((0,o.Z)(t)),e.baseRender&&(t.render=e.baseRender((0,o.Z)(t))),t}return(0,r.Z)(d,[{key:"showPosts",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"datasource"===this.props.element.getSettings("choose_datasource")||!(!e.modelName&&!e.dataSource)}},{key:"render",value:function(){if(!this.props.currentModel.getProperty("altrpModelUpdated"))return"";var e=new u.Z(this.props.element.getSettings().table_query||{},this);if(!this.showPosts(e))return React.createElement("div",{children:"Please Choose Source"});var t=e.getFromModel(this.state.modelData)||[];if("datasource"===this.props.element.getSettings("choose_datasource")){var n=this.props.element.getSettings("posts_datasource","");n=n.replace(/}}/g,"").replace(/{{/g,""),t=(0,c.getDataByPath)(n,[],this.props.element.getCurrentModel().getData())}return React.createElement(k,{query:e,currentModel:this.props.currentModel,data:t,element:this.props.element,settings:this.props.element.getSettings()})}}]),d}(Component)},75429:function(e,t,n){"use strict";var s=n(81253),a=n(22122),r=n(6610),o=n(5991),i=n(10379),p=n(46070),l=n(77608),u=n(67294),c=(n(22368),n(73935),n(53569)),d=n(75912);var m,f,g,h=(0,(n(81144),n(35639),n(61085)).m)(d.S),v=(m=h,g=f=function(e){(0,i.Z)(f,e);var t,n,d=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,s=(0,l.Z)(t);if(n){var a=(0,l.Z)(this).constructor;e=Reflect.construct(s,arguments,a)}else e=s.apply(this,arguments);return(0,p.Z)(this,e)});function f(e){var t;return(0,r.Z)(this,f),(t=d.call(this)).select=void 0,t.lastRequest=void 0,t.mounted=!1,t.optionsCache={},t.handleInputChange=function(e,n){var s=t.props,a=s.cacheOptions,r=s.onInputChange,o=(0,c.G)(e,n,r);if(!o)return delete t.lastRequest,void t.setState({inputValue:"",loadedInputValue:"",loadedOptions:[],isLoading:!1,passEmptyOptions:!1});if(a&&t.optionsCache[o])t.setState({inputValue:o,loadedInputValue:o,loadedOptions:t.optionsCache[o],isLoading:!1,passEmptyOptions:!1});else{var i=t.lastRequest={};t.setState({inputValue:o,isLoading:!0,passEmptyOptions:!t.state.loadedInputValue},(function(){t.loadOptions(o,(function(e){t.mounted&&(e&&(t.optionsCache[o]=e),i===t.lastRequest&&(delete t.lastRequest,t.setState({isLoading:!1,loadedInputValue:o,loadedOptions:e||[],passEmptyOptions:!1})))}))}))}return o},t.state={defaultOptions:Array.isArray(e.defaultOptions)?e.defaultOptions:void 0,inputValue:void 0!==e.inputValue?e.inputValue:"",isLoading:!0===e.defaultOptions,loadedOptions:[],passEmptyOptions:!1},t}return(0,o.Z)(f,[{key:"componentDidMount",value:function(){var e=this;this.mounted=!0;var t=this.props.defaultOptions,n=this.state.inputValue;!0===t&&this.loadOptions(n,(function(t){if(e.mounted){var n=!!e.lastRequest;e.setState({defaultOptions:t||[],isLoading:n})}}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.cacheOptions!==this.props.cacheOptions&&(this.optionsCache={}),e.defaultOptions!==this.props.defaultOptions&&this.setState({defaultOptions:Array.isArray(e.defaultOptions)?e.defaultOptions:void 0})}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"loadOptions",value:function(e,t){var n=this.props.loadOptions;if(!n)return t();var s=n(e,t);s&&"function"==typeof s.then&&s.then(t,(function(){return t()}))}},{key:"render",value:function(){var e=this,t=this.props,n=(t.loadOptions,t.isLoading),r=(0,s.Z)(t,["loadOptions","isLoading"]),o=this.state,i=o.defaultOptions,p=o.inputValue,l=o.isLoading,c=o.loadedInputValue,d=o.loadedOptions,f=o.passEmptyOptions?[]:p&&c?d:i||[];return u.createElement(m,(0,a.Z)({},r,{ref:function(t){e.select=t},options:f,isLoading:l||n,onInputChange:this.handleInputChange}))}}]),f}(u.Component),f.defaultProps={cacheOptions:!1,defaultOptions:!1,filterOption:null,isLoading:!1},g);t.ZP=v}}]);
//# sourceMappingURL=PostsWidget.e885e067470ef46a35d1.bundle.js.map