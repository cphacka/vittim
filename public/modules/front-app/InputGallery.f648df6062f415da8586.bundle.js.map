{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./resources/modules/editor/src/js/components/widgets/InputGalleryWidget.js","webpack:///./resources/modules/front-app/src/js/classes/AltrpFile.js","webpack:///./resources/modules/front-app/src/js/store/forms-data-storage/actions.js"],"names":["_assertThisInitialized","self","ReferenceError","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","TypeError","prototype","create","constructor","_possibleConstructorReturn","call","_setPrototypeOf","p","_typeof","Symbol","iterator","CloseIcon","window","altrpHelpers","isEditor","parseOptionsFromSettings","replaceContentWithData","getDataFromLocalStorage","FileInput","altrpLibs","Blueprint","globalDefaults","push","InputGalleryWidget","props","getValue","formId","element","getFormId","fieldName","getFieldId","state","_","get","appStore","getState","formsStore","isArray","onChange","filesStorage","setState","dispatchFieldValueToStore","userInput","indexOf","isObject","dispatch","changeFormFieldValue","change_actions","getSettings","actionsManager","default","callAllWidgetActions","getIdForAction","addElements","e","notActive","files","target","limit","getResponsiveSetting","map","file","idx","AltrpFile","concat","Promise","all","storeFile","getProperty","console","error","slice","Math","random","forEach","getFile","reader","FileReader","readAsDataURL","onload","result","component","elementDecorator","settings","defaultValue","imageUrls_0","getDefaultValue","altrpSelectRef","React","item","this","filter","fileToDelete","deleteFileFromStorage","v","prevProps","prevState","options","currentModel","contentLoaded","currentDataStorage","content_options","model_for_options","isEqual","updateValue","getContent","isEmpty","media","newFile","setProperty","url","id","content_calculation","altrpforms","prevContext","altrpdata","getData","altrpmodel","altrpuser","currentUser","altrppagestate","altrpPageState","altrpresponses","altrpmeta","altrpMeta","context","getCurrentModel","currentDataStorageLoaded","changedField","altrpstorage","replace","eval","message","getId","path","inputProps","name","getName","accept","multiple","fileInputProps","style","pointerEvents","backgroundImage","onInputChange","className","length","display","deleteText","title","onClick","deleteItem","Component","data","File","type","getResource","postFiles","response","delete","getFileName","resource","Resource","route","AltrpModel","CHANGE_FORM_FIELD_VALUE","CLEAR_FORM_FIELD_VALUE"],"mappings":"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","file":"InputGallery.f648df6062f415da8586.bundle.js","sourcesContent":["export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import AltrpFile from \"../../../../../front-app/src/js/classes/AltrpFile\";\r\nimport CloseIcon from \"../../../svgs/times.svg\"\r\n\r\nconst {\r\n  isEditor,\r\n  parseOptionsFromSettings,\r\n  replaceContentWithData,\r\n  getDataFromLocalStorage\r\n} = window.altrpHelpers;\r\nimport {changeFormFieldValue} from \"../../../../../front-app/src/js/store/forms-data-storage/actions\";\r\n\r\nconst FileInput = window.altrpLibs.Blueprint.FileInput;\r\n\r\n(window.globalDefaults = window.globalDefaults || []).push(`\r\n.altrp-widget_input-gallery .bp3-file-upload-input{\r\n    display: none;\r\n}\r\n.altrp-widget_input-gallery .bp3-file-upload-input::after{\r\n  width: auto;\r\n  min-width: 0;\r\n  display: none;\r\n}\r\n.input-gallery__item.input-gallery__item{\r\n  height: 100px;\r\n}\r\n.input-gallery__item.input-gallery__item.input-gallery__item.input-gallery__item{\r\n  background-repeat: no-repeat;\r\n  background-size: contain;\r\n  background-position: center;\r\n  position: relative;\r\n    width:100%;\r\n}\r\n.input-gallery__item.input-gallery__item svg{\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    cursor: pointer;\r\n}\r\n.input-gallery-wrapper{\r\n    display: grid;\r\n    grid-auto-flow: row dense;\r\n    }\r\n`)\r\n\r\nclass InputGalleryWidget extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    props.element.component = this;\r\n    if (window.elementDecorator) {\r\n      window.elementDecorator(this);\r\n    }\r\n    const state ={\r\n      settings: {...props.element.getSettings()},\r\n      value: this.defaultValue,\r\n      imageUrls_0: _.get(props.element.getResponsiveSetting('preview_placeholder'), 'url'),\r\n    };\r\n    this.defaultValue = this.getDefaultValue(state)\r\n\r\n    this.state = state;\r\n    this.altrpSelectRef = React.createRef();\r\n    if (this.defaultValue) {\r\n      this.dispatchFieldValueToStore(this.defaultValue);\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param e\r\n   * @param item\r\n   */\r\n  async deleteItem(e, item){\r\n    this.setState(state => ({...state, notActive: true}))\r\n    let filesStorage = this.state.filesStorage;\r\n    let value = this.getValue()\r\n    let fileToDelete;\r\n    filesStorage = filesStorage.filter(file => {\r\n      if(file.getProperty('media.id') === item){\r\n        fileToDelete = file;\r\n      }\r\n      return file.getProperty('media.id') !== item\r\n    })\r\n    if(fileToDelete){\r\n      try {\r\n        await fileToDelete.deleteFileFromStorage()\r\n      } catch (e) {console.error(e);}\r\n    }\r\n    value = value.filter(v => v !== item)\r\n    try {\r\n      const limit = this.props.element.getResponsiveSetting('limit');\r\n      _.forEach(filesStorage, (file, idx) => {\r\n        if (limit && idx >= limit) {\r\n          return\r\n        }\r\n        if(file.getFile()){\r\n          const reader = new FileReader\r\n          reader.readAsDataURL(file.getFile())\r\n          reader.onload = () => {\r\n            this.setState(state => {\r\n                state[`imageUrls_${idx}`] = reader.result;\r\n                return {...state};\r\n              }\r\n            )\r\n          }\r\n        } else {\r\n          this.setState(state => {\r\n            state[`imageUrls_${idx}`] = file.getProperty('media.url');\r\n            return {...state};\r\n          })\r\n        }\r\n      })\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    this.setState(state => ({...state, notActive: false}))\r\n    this.onChange(value, filesStorage)\r\n  }\r\n\r\n  /**\r\n   * Чистит значение\r\n   */\r\n  clearValue() {\r\n    this.onChange([]);\r\n    this.dispatchFieldValueToStore(null, true);\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   * @returns {[]}\r\n   */\r\n  getValue = () => {\r\n    let value;\r\n    let formId = this.props.element.getFormId();\r\n    let fieldName = this.props.element.getFieldId();\r\n    if (isEditor()) {\r\n      value = this.state.value;\r\n    } else {\r\n      value = _.get(appStore.getState().formsStore, `${formId}`, '')\r\n      value = _.get(value, fieldName, '')\r\n      if(! _.isArray(value)){\r\n        value = [value]\r\n      }\r\n    }\r\n    return value || [];\r\n  }\r\n\r\n  /**\r\n   * Загрузка виджета\r\n   * @param {{}} prevProps\r\n   * @param {{}} prevState\r\n   */\r\n  async _componentDidMount(prevProps, prevState) {\r\n    if (this.props.element.getSettings(\"content_options\")) {\r\n      let options = parseOptionsFromSettings(\r\n        this.props.element.getSettings(\"content_options\")\r\n      );\r\n\r\n      this.setState(state => ({...state, options}));\r\n    }\r\n\r\n    let value = this.state.value;\r\n\r\n    /**\r\n     * Если модель обновилась при смене URL\r\n     */\r\n    if (\r\n      prevProps &&\r\n      !prevProps.currentModel.getProperty(\"altrpModelUpdated\") &&\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\")\r\n    ) {\r\n      value = this.getDefaultValue();\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\") &&\r\n      this.props.currentDataStorage.getProperty(\"currentDataStorageLoaded\") &&\r\n      !this.state.contentLoaded\r\n    ) {\r\n      value = this.getDefaultValue() || [];\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (this.state.value !== value) {\r\n      this.setState(\r\n        state => ({...state, value}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Обновление виджета\r\n   */\r\n  async _componentDidUpdate(prevProps, prevState) {\r\n    const {content_options, model_for_options} = this.state.settings;\r\n    if (!this.getValue() && this.state.imageUrls_0 !== _.get(this.props.element.getResponsiveSetting('preview_placeholder'), 'url')) {\r\n      this.setState(\r\n        state => ({...state, imageUrls_0: _.get(this.props.element.getResponsiveSetting('preview_placeholder'), 'url')})\r\n      )\r\n    }\r\n    if (\r\n      prevProps &&\r\n      !prevProps.currentDataStorage.getProperty(\"currentDataStorageLoaded\") &&\r\n      this.props.currentDataStorage.getProperty(\"currentDataStorageLoaded\")\r\n    ) {\r\n      let value = this.getDefaultValue();\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    }\r\n\r\n\r\n    if (content_options && !model_for_options) {\r\n      let options = parseOptionsFromSettings(content_options);\r\n      if (!_.isEqual(options, this.state.options)) {\r\n        this.setState(state => ({...state, options}));\r\n      }\r\n    }\r\n    this.updateValue(prevProps);\r\n  }\r\n\r\n  /**\r\n   * @param {{} | null} state\r\n   * @returns {*[]}\r\n   */\r\n  getDefaultValue(state) {\r\n\r\n    let value = this.getContent(\"default_value\", true) || []\r\n    if(! _.isArray(value) && ! _.isEmpty(value)){\r\n      value = [value];\r\n    }\r\n\r\n    let filesStorage = _.map(value, (media, idx) => {\r\n      const newFile =  new AltrpFile()\r\n      newFile.setProperty('media', media)\r\n      return newFile\r\n    })\r\n    value.forEach((v, idx)=>{\r\n      if(!v?.url){\r\n        return\r\n      }\r\n      if(state){\r\n        state[`imageUrls_${idx}`] = v.url\r\n        state.filesStorage = filesStorage\r\n      } else {\r\n        this.setState(state=>{\r\n          // this.state[]\r\n          state[`imageUrls_${idx}`] = v.url\r\n          state.filesStorage = filesStorage\r\n        })\r\n      }\r\n    })\r\n    value = value.map(v => v.id)\r\n    return value\r\n  }\r\n  /**\r\n   * Обновить значение если нужно\r\n   * @param {{}} prevProps\r\n   */\r\n  updateValue(prevProps) {\r\n\r\n    if (isEditor()) {\r\n      return;\r\n    }\r\n\r\n    let content_calculation = this.props.element.getSettings(\r\n      \"content_calculation\"\r\n    );\r\n    const altrpforms = this.props.formsStore;\r\n    const fieldName = this.props.element.getFieldId();\r\n    const formId = this.props.element.getFormId();\r\n\r\n    if (!content_calculation) {\r\n      /**\r\n       * Обновить значение, если formsStore изменилось из другого компонента\r\n       */\r\n      const path = `${formId}.${fieldName}`;\r\n      if (\r\n        this.props.formsStore !== prevProps.formsStore &&\r\n        _.get(altrpforms, path) !== this.state.value\r\n      ) {\r\n        this.setState(state => ({\r\n          ...state,\r\n          value: _.get(altrpforms, path)\r\n        }));\r\n      }\r\n      return;\r\n    }\r\n\r\n    const prevContext = {};\r\n    const altrpdata = this.props.currentDataStorage.getData();\r\n    const altrpmodel = this.props.currentModel.getData();\r\n    const altrpuser = this.props.currentUser.getData();\r\n    const altrppagestate = this.props.altrpPageState.getData();\r\n    const altrpresponses = this.props.altrpresponses.getData();\r\n    const altrpmeta = this.props.altrpMeta.getData();\r\n    const context = this.props.element.getCurrentModel().getData();\r\n\r\n    if (content_calculation.indexOf(\"altrpdata\") !== -1) {\r\n      context.altrpdata = altrpdata;\r\n      if (!altrpdata.currentDataStorageLoaded) {\r\n        prevContext.altrpdata = altrpdata;\r\n      } else {\r\n        prevContext.altrpdata = prevProps.currentDataStorage.getData();\r\n      }\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpforms\") !== -1) {\r\n      context.altrpforms = altrpforms;\r\n      /**\r\n       * Не производим вычисления, если изменилось текущее поле\r\n       */\r\n      if (`${formId}.${fieldName}` === altrpforms.changedField) {\r\n        prevContext.altrpforms = altrpforms;\r\n      } else {\r\n        prevContext.altrpforms = prevProps.formsStore;\r\n      }\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpmodel\") !== -1) {\r\n      context.altrpmodel = altrpmodel;\r\n      prevContext.altrpmodel = prevProps.currentModel.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpuser\") !== -1) {\r\n      context.altrpuser = altrpuser;\r\n      prevContext.altrpuser = prevProps.currentUser.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpuser\") !== -1) {\r\n      context.altrpuser = altrpuser;\r\n      prevContext.altrpuser = prevProps.currentUser.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrppagestate\") !== -1) {\r\n      context.altrppagestate = altrppagestate;\r\n      prevContext.altrppagestate = prevProps.altrpPageState.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpmeta\") !== -1) {\r\n      context.altrpmeta = altrpmeta;\r\n      prevContext.altrpmeta = prevProps.altrpMeta.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpresponses\") !== -1) {\r\n      context.altrpresponses = altrpresponses;\r\n      prevContext.altrpresponses = prevProps.altrpresponses.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpstorage\") !== -1) {\r\n      context.altrpstorage = getDataFromLocalStorage(\"altrpstorage\", {});\r\n    }\r\n\r\n    if (\r\n      _.isEqual(prevProps.currentDataStorage, this.props.currentDataStorage) &&\r\n      _.isEqual(prevProps.currentUser, this.props.currentUser) &&\r\n      _.isEqual(prevProps.formsStore, this.props.formsStore) &&\r\n      _.isEqual(prevProps.altrpPageState, this.props.altrpPageState) &&\r\n      _.isEqual(prevProps.altrpMeta, this.props.altrpMeta) &&\r\n      _.isEqual(prevProps.altrpresponses, this.props.altrpresponses) &&\r\n      _.isEqual(prevProps.currentModel, this.props.currentModel)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !_.isEqual(prevProps.formsStore, this.props.formsStore) &&\r\n      `${formId}.${fieldName}` === altrpforms.changedField\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    let value = \"\";\r\n\r\n    try {\r\n      content_calculation = content_calculation\r\n        .replace(/}}/g, \"')\")\r\n        .replace(/{{/g, \"_.get(context, '\");\r\n      value = eval(content_calculation);\r\n      if (value === this.state.value) {\r\n        return;\r\n      }\r\n      this.setState(\r\n        state => ({...state, value}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    } catch (e) {\r\n      console.error(\r\n        \"Evaluate error in Input: '\" + e.message + \"'\",\r\n        this.props.element.getId()\r\n      );\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Изменение значения в виджете\r\n   * @param {[]} value\r\n   * @param {[]| null} filesStorage\r\n   */\r\n  onChange = async (value, filesStorage = null) => {\r\n    this.setState(state => ({...state, filesStorage}))\r\n    if (isEditor()) {\r\n      this.setState(state => ({...state, value}))\r\n    } else {\r\n      this.dispatchFieldValueToStore(value, true)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Передадим значение в хранилище формы\r\n   * @param {*} value\r\n   * @param {boolean} userInput true - имзенилось пользователем\r\n   */\r\n  dispatchFieldValueToStore = async (value, userInput = false) => {\r\n    let formId = this.props.element.getFormId();\r\n    let fieldName = this.props.element.getFieldId();\r\n\r\n    if (fieldName.indexOf(\"{{\") !== -1) {\r\n      fieldName = replaceContentWithData(fieldName);\r\n    }\r\n    if (_.isObject(this.props.appStore) && fieldName && formId) {\r\n      this.props.appStore.dispatch(\r\n        changeFormFieldValue(fieldName, value, formId, userInput)\r\n      );\r\n\r\n      if (userInput) {\r\n        const change_actions = this.props.element.getSettings(\"change_actions\");\r\n\r\n        if (change_actions && !isEditor()) {\r\n          const actionsManager = (\r\n            await import(\r\n              /* webpackChunkName: 'ActionsManager' */\r\n              \"../../../../../front-app/src/js/classes/modules/ActionsManager.js\"\r\n              )\r\n          ).default;\r\n          await actionsManager.callAllWidgetActions(\r\n            this.props.element.getIdForAction(),\r\n            \"change\",\r\n            change_actions,\r\n            this.props.element\r\n          );\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  addElements = async (e) => {\r\n    this.setState(state => ({...state, notActive: true}))\r\n    let {filesStorage} = this.state;\r\n    filesStorage = filesStorage || []\r\n    let files = e.target.files;\r\n    const limit = this.props.element.getResponsiveSetting('limit');\r\n    let value = this.getValue();\r\n\r\n    files = _.map(files, (file, idx) => {\r\n      return new AltrpFile(file)\r\n    })\r\n    filesStorage = filesStorage.concat(files)\r\n    this.setState(state => ({...state, filesStorage: value}))\r\n    try {\r\n      value = value.concat(\r\n        await Promise.all(\r\n          files.map(async file => ((await file.storeFile()).getProperty('media.id')))\r\n        )\r\n      )\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n\r\n    if (limit) {\r\n      value = value.slice(0, limit)\r\n      filesStorage = filesStorage.slice(0, limit)\r\n    }\r\n    this.onChange(value, filesStorage)\r\n    this.setState(state => ({...state, key: Math.random()}))\r\n    try {\r\n      _.forEach(filesStorage, (file, idx) => {\r\n        if (limit && idx >= limit) {\r\n          return\r\n        }\r\n        if(file.getFile()){\r\n          const reader = new FileReader\r\n          reader.readAsDataURL(file.getFile())\r\n          reader.onload = () => {\r\n            this.setState(state => {\r\n                state[`imageUrls_${idx}`] = reader.result;\r\n                return {...state};\r\n              }\r\n            )\r\n          }\r\n        } else {\r\n          this.setState(state => {\r\n            state[`imageUrls_${idx}`] = file.getProperty('media.url');\r\n            return {...state};\r\n          })\r\n        }\r\n      })\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    this.setState(state => ({...state, notActive: false}))\r\n  }\r\n\r\n  /**\r\n   * Взовращает имя для атрибута name\r\n   * @return {string}\r\n   */\r\n  getName() {\r\n    return `${this.props.element.getFormId()}[${this.props.element.getFieldId()}]`;\r\n  }\r\n\r\n  render() {\r\n    const {element} = this.props\r\n\r\n    const inputProps = {\r\n      name: this.getName(),\r\n      accept: element.getResponsiveSetting('accept'),\r\n      multiple: 1,\r\n    }\r\n    const {notActive} = this.state\r\n    const value = this.getValue()\r\n\r\n    const limit = element.getResponsiveSetting('limit')\r\n    const fileInputProps = {\r\n      key: this.state.key,\r\n      inputProps,\r\n      style: {\r\n        pointerEvents: notActive ? 'none' : '',\r\n        backgroundImage: `url(${element.getResponsiveSetting('placeholder')?.url || \"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDY0IDY0IiB3aWR0aD0iMTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGNsYXNzPSJpY29uIj48cGF0aCBkPSJNMjMuNDE0IDIxLjQxNEwzMCAxNC44MjhWNDRhMiAyIDAgMDA0IDBWMTQuODI4bDYuNTg2IDYuNTg2Yy4zOS4zOTEuOTAyLjU4NiAxLjQxNC41ODZzMS4wMjQtLjE5NSAxLjQxNC0uNTg2YTIgMiAwIDAwMC0yLjgyOGwtMTAtMTBhMiAyIDAgMDAtMi44MjggMGwtMTAgMTBhMiAyIDAgMTAyLjgyOCAyLjgyOHoiPjwvcGF0aD48cGF0aCBkPSJNNTAgNDBhMiAyIDAgMDAtMiAydjhjMCAxLjEwMy0uODk3IDItMiAySDE4Yy0xLjEwMyAwLTItLjg5Ny0yLTJ2LThhMiAyIDAgMDAtNCAwdjhjMCAzLjMwOSAyLjY5MSA2IDYgNmgyOGMzLjMwOSAwIDYtMi42OTEgNi02di04YTIgMiAwIDAwLTItMnoiPjwvcGF0aD48L3N2Zz4K\"})`\r\n      },\r\n      onInputChange: this.addElements,\r\n      className: `bp3-file-input_preview input-gallery__item`,\r\n    }\r\n    if (limit && value.length >= limit) {\r\n      fileInputProps.style.display = 'none'\r\n    }\r\n    const deleteText = element.getResponsiveSetting('delete', '')\r\n    return (\r\n      <div className=\"input-gallery-wrapper\">\r\n        {value.map((item, idx) => {\r\n          return <div\r\n            className=\"input-gallery__item\"\r\n            title={deleteText}\r\n            style={{\r\n              backgroundImage: `url(${this.state[`imageUrls_${idx}`]})`\r\n            }}\r\n            key={item}>\r\n            {<CloseIcon className=\"input-gallery__delete\" onClick={(e) => {\r\n              this.deleteItem(e, item)\r\n            }}/>}\r\n          </div>\r\n        })}\r\n        <FileInput {...fileInputProps} />\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nexport default InputGalleryWidget;\r\n","/**\r\n * @class AltrpFile\r\n */\r\nclass AltrpFile extends AltrpModel{\r\n  constructor(data) {\r\n    if(data instanceof File){\r\n      data = {file: data}\r\n    }\r\n    // if(! data.file instanceof File){\r\n    //   throw new Error('Need a File instance in AltrpFile Constructor')\r\n    // }\r\n    super(data);\r\n    if(data?.file?.type?.indexOf('image') >= 0){\r\n      const reader = new FileReader\r\n      reader.onload = ()=>{\r\n        this.setProperty('dataAsUrl', reader.result)\r\n      }\r\n      reader.readAsDataURL(data.file)\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Promise<AltrpFile>}\r\n   */\r\n  async storeFile(){\r\n    try {\r\n      let response = await AltrpFile.getResource().postFiles([this.getFile()])\r\n      this.setProperty('media', response[0])\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    return this\r\n  }\r\n  /**\r\n   *\r\n   * @returns {Promise<AltrpFile>}\r\n   */\r\n  async deleteFileFromStorage(){\r\n    const id = this.getProperty('media.id');\r\n    if(! id){\r\n      return this\r\n    }\r\n    try {\r\n      let response = await AltrpFile.getResource().delete(id)\r\n      this.setProperty('media', null)\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * @return {File}\r\n   */\r\n  getFile(){\r\n    return this.getProperty('file')\r\n  }\r\n  getFileName(){\r\n    return this.getFile()?.name || ''\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {string}\r\n   */\r\n  toString(){\r\n    return this.getFileName()\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Resource}\r\n   */\r\n  static getResource(){\r\n    if(! AltrpFile.resource){\r\n      AltrpFile.resource = new window.altrpHelpers.Resource({route: '/ajax/media'})\r\n    }\r\n    return AltrpFile.resource\r\n  }\r\n}\r\n\r\nexport default AltrpFile\r\n","export const CHANGE_FORM_FIELD_VALUE = 'CHANGE_FORM_FIELD_VALUE';\r\nexport const CLEAR_FORM_FIELD_VALUE = 'CHANGE_FORM_FIELD_VALUE';\r\n\r\n/**\r\n * Получает данные поля формы и сохраняет в хранилище\r\n * @param {string}fieldName\r\n * @param {*}value\r\n * @param {string}formId\r\n * @param {boolean}userInput\r\n * @return {{type: string, fieldName: *, value: *, formId: *}}\r\n */\r\nexport function changeFormFieldValue(fieldName, value, formId, userInput) {\r\n\r\n  return {\r\n    type: CHANGE_FORM_FIELD_VALUE,\r\n    fieldName,\r\n    value,\r\n    formId,\r\n    changedField: userInput ? `${formId}.${fieldName}` : null,\r\n  };\r\n}\r\n/**\r\n * Очистить данные поля формы и сохраняет в хранилище\r\n * @param {string | null}formId\r\n * @return {{type: string, fieldName: *, value: *, formId: *}}\r\n */\r\nexport function clearFormStorage(formId = null) {\r\n  return {\r\n    type: CLEAR_FORM_FIELD_VALUE,\r\n    formId,\r\n  };\r\n}\r\n\r\n"],"sourceRoot":""}