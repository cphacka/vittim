(self.webpackChunk=self.webpackChunk||[]).push([[3974],{71743:function(e,t,r){"use strict";var n=r(6610),o=r(5991),i=r(83465),a=r.n(i),s=r(29208),l=r.n(s),c=r(31468),d=r.n(c),u=r(38394),p=r.n(u),h=r(96633),f=r.n(h),g=r(99245),v=r.n(g),b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,e),this.data=a()(t)}return(0,o.Z)(e,[{key:"getData",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?a()(this.data):this.data}},{key:"isEmpty",value:function(){return v()(this.data)}},{key:"getProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return l()(this.data,e,t)}},{key:"hasProperty",value:function(e){return p()(this.data,e)}},{key:"setProperty",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return r instanceof e&&(r=r.getData(!1)),d()(this.data,t,r)}},{key:"unsetProperty",value:function(e){return f()(this.data,e)}}]),e}();window.AltrpModel=b,t.Z=b},1866:function(e,t,r){"use strict";r.d(t,{Z:function(){return Z}});var n,o,i,a=r(96156),s=r(6610),l=r(5991),c=r(10379),d=r(46070),u=r(77608),p=r(22122),h=r(32465),f=r(71893),g="#eee",v=f.ZP.span(o||(o=(0,h.Z)(["\n  animation: "," 1.2s ease-in-out infinite;\n  background-color: ",";\n  background-size: 200px 100%;\n  background-repeat: no-repeat;\n  background-image: linear-gradient(90deg, ",");\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 100%;\n"])),(function(e,t){return(0,f.F4)(n||(n=(0,h.Z)(["\n  0% {\n    background-position: -200px 0;\n  }\n  ","\n  100% {\n    background-position: calc(200px + 100%) 0;\n  }\n"])),t>0?"".concat(Math.floor(1/(e+t)*e*100),"% {\n    background-position: calc(200px + 100%) 0;\n  }"):void 0)}),(function(e){var t=e.color;return"".concat(t||g)}),(function(e){var t=e.highlightColor,r=e.color;return"".concat(r||g,", ").concat(t||"#f5f5f5",", ").concat(r||g)})),b=function(e){return React.createElement("div",{className:e.className},React.createElement(v,(0,p.Z)({},e,{className:"altrp-skeleton__span"})))},m=r(76593),y=f.ZP.div(i||(i=(0,h.Z)(["& {\n  position: relative;\n  max-width: 100%;\n  overflow: hidden;\n  width:",";\n","\n\n  background-color: ",";\n}\n&::before{\n  display: block;\n  content: '';\n  width: 100%;\n",";\n}\n&& .altrp-skeleton,\n&& .altrp-image{\n  position:absolute;\n  top:0;\n  left:0;\n  right:0;\n  bottom:0;\n  height:100%;\n  width:100%;\n}\n"])),(function(e){return _.isNumber(e.width)?e.width+"px":e.width?e.width:"100%"}),(function(e){var t=e.settings,r=(0,m.getResponsiveSetting)(t,"aspect_ratio_size");return 0!==Number(r)&&"custom"===r||Number(r)?"height:auto;":e.height&&-1===e.height.indexOf("%")?"height:".concat(e.height?e.height:"auto",";"):"height:auto;"}),(function(e){return e.color?e.color:"#fff"}),(function(e){var t=e.settings,r=e.height,n="",o=(0,m.getResponsiveSetting)(t,"aspect_ratio_size");if(0!==Number(o)){if("custom"===o){var i=(0,m.getResponsiveSetting)(t,"custom_aspect");i=Number(i)||100,n+="padding-top:".concat(i,"%;")}else Number(o)&&(n+="padding-top:".concat(o,"%;"));return n}return r&&_.isString(r)&&-1===r.indexOf("%")||Number(e.mediaWidth)&&Number(e.mediaHeight)&&(n+="padding-top:".concat(e.mediaHeight/e.mediaWidth*100,"%;")),n})),w=r(29459);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S=window.altrpHelpers,O=S.isEditor,R=S.isSSR,E=S.renderAsset,P=function(e){(0,c.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var o=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function o(e){var t,r,i;(0,s.Z)(this,o),(i=n.call(this,e)).imageRef=React.createRef();var a=!0;return(!R()||null!==(t=e.element)&&void 0!==t&&t.getResponsiveSetting("lazyload_disable"))&&(O()||!1===e.lazy||!window.altrpImageLazy||"none"===window.altrpImageLazy||!e.element||null!==(r=e.element)&&void 0!==r&&r.getResponsiveSetting("lazyload_disable"))||(a=!1),i.state={visible:a,update:0},i.timeoutId=setTimeout((function(){return i.setState((function(e){return N(N({},e),{},{update:e.update++})}))}),500),i}return(0,l.Z)(o,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"componentDidUpdate",value:function(e,t){var r,n,o;if(this.state.visible&&clearTimeout(this.timeoutId),!this.state.visible&&this.imageRef.current&&(null!==(r=this.props)&&void 0!==r&&null!==(n=r.element)&&void 0!==n&&null!==(o=n.getRoot())&&void 0!==o&&o.popupGUID&&this.props.element.getRoot().popupGUID===this.props.popupTrigger.popupID&&this.setState((function(e){return N(N({},e),{},{visible:!0})})),e.scrollPosition!==this.props.scrollPosition||t.update!==this.state.update)){var i=window.mainScrollbars;i||(i=document.querySelector(".front-app-content")),i||(i=document.querySelector(".front-app")),this.imageRef.current&&(0,w.nX)(this.imageRef.current,i)&&(clearTimeout(this.timeoutId),this.setState((function(e){return N(N({},e),{},{visible:!0})})))}}},{key:"render",value:function(){var e,t=N({},this.props.image),r=this.state.visible,n=this.props.noDefault||!1,o={},i=this.props.width,a=this.props.height;if(!R()&&this.props.image instanceof File)t=this.props.image;else if(this.props.default)0===Object.keys(t).length&&(t=this.props.default);else{if(n)return"";t.url=t.url||"/img/nullImage.png",t.name=t.name||"null",t.assetType=t.assetType||void 0}var s=E(t);(r||"skeleton"===window.altrpImageLazy)&&(o.background="transparent");var l=React.createElement(y,{color:t.main_color,className:"altrp-image-placeholder ",ref:this.imageRef,settings:(null===(e=this.props.element)||void 0===e?void 0:e.getSettings())||{},height:a,width:i,style:o,mediaWidth:t.width||100,mediaHeight:t.height||75},"skeleton"===window.altrpImageLazy&&!r&&React.createElement(b,{className:"altrp-skeleton",color:window.altrpSkeletonColor,highlightColor:window.altrpSkeletonHighlightColor}),r&&React.cloneElement(s,{className:this.props.className,id:this.props.id||null,style:this.props.style}));return React.createElement(React.Fragment,null,l)}}]),o}(Component),Z=O()?P:window.reactRedux.connect((function(e){return{scrollPosition:e.scrollPosition,popupTrigger:e.popupTrigger}}))(P)},85457:function(e,t,r){"use strict";r.r(t),r.d(t,{normalizeValues:function(){return k},getFromDatasource:function(){return N},updateRepeater:function(){return S},childrenInChildren:function(){return O}});var n=r(6610),o=r(5991),i=r(63349),a=r(10379),s=r(46070),l=r(77608),c=r(96156),d=r(67294),u=r(88425);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=window.altrpHelpers,v=g.getDataByPath,b=g.isEditor,m=g.parseOptionsFromSettings,y=g.renderAsset,w=(g.renderAssetIcon,window.altrpLibs.Blueprint.Tree),k=function(e){var t="folder-close",r=e.icon||t,n=e.label||"Label";return f(f({},e),{},{labelValue:n,label:n,icon:-1!==r.indexOf("/")||r.url?y(r):t,iconValue:r,treeId:e.tree_id||-1,parentId:e.parent||-1})},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["tree_from_datasource","tree_substitute_datasource"];e.path=this.props.element.getSettings(t[0],""),e.path=e.path.replace(/}}/g,"").replace(/{{/g,""),e.dataSettings=m(this.props.element.getSettings(t[1])),e.sortDefault=this.props.element.getSettings("sort_default"),e.sortOption=this.props.element.getSettings("options_sorting");var r=v(e.path,[],this.props.element.getCurrentModel().getData());return _.isArray(r)?r:[]},S=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];e.forEach((function(o,i){var a=[],s=t.normalizeValues(o);-1!==s.treeId&&e.forEach((function(e,r){i!==r&&(e.parent||-1)===s.treeId&&a.push(f(f({},t.normalizeValues(e)),{},{id:r}))})),null==r||!r.sort||null!=r&&r.sort[0]||(a=_.sortBy(a,(function(e){return e&&(e.label?e.label.toString():e)})),"desc"===r.sort[1]&&(a=_.reverse(a))),n.push(f(f({},s),{},{id:i,hasCaret:-1!==s.treeId,childNodes:a}))}));var o=[];return n.forEach((function(e){o.push(f(f({},e),{},{childNodes:t.childrenInChildren(e.childNodes,n)}))})),null==r||!r.sort||null!=r&&r.sort[0]||(o=_.sortBy(o,(function(e){return e&&(e.label?e.label.toString():e)})),"desc"===r.sort[1]&&(o=_.reverse(o))),o.filter((function(e){return-1===e.parentId}))},O=function(e,t){var r=this,n=[];return e.length>0&&e.forEach((function(e){t.forEach((function(o){e.id===o.id&&(o.childNodes=r.childrenInChildren(o.childNodes,t),n.push(o))}))})),n},R=function(e){(0,a.Z)(h,e);var t,r,c=(t=h,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,l.Z)(t);if(r){var o=(0,l.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function h(e){var t;(0,n.Z)(this,h),(t=c.call(this,e)).normalizeValues=k,t.getFromDatasource=N,t.updateRepeater=S,t.childrenInChildren=O;var r=e.element.getSettings();return t.state={settings:r,type:r.select_type||"repeater",repeater:[]},e.element.component=(0,i.Z)(t),window.elementDecorator&&window.elementDecorator((0,i.Z)(t)),e.baseRender&&(t.render=e.baseRender((0,i.Z)(t))),t.updateNode=t.updateNode.bind((0,i.Z)(t)),t.handleNodeExpand=t.handleNodeExpand.bind((0,i.Z)(t)),t.handleNodeCollapse=t.handleNodeCollapse.bind((0,i.Z)(t)),t.handleNodeClick=t.handleNodeClick.bind((0,i.Z)(t)),t}return(0,o.Z)(h,[{key:"_componentDidMount",value:function(){var e={type:this.state.type};if("repeater"===e.type){e.repeater=this.props.element.getResponsiveSetting("tree_repeater","",[]);var t=this.updateRepeater(e.repeater);this.setState((function(e){return f(f({},e),{},{repeater:t})}))}else if("datasource"===e.type){var r=this.getFromDatasource(e)||[];this.setState((function(e){return f(f({},e),{},{repeater:r})}))}}},{key:"_componentDidUpdate",value:function(e,t){var r=this,n={type:this.state.type};if(b()){if("repeater"===n.type&&(n.repeater=this.props.element.getResponsiveSetting("tree_repeater","",[]),n.prevRepeater=t.settings.tree_repeater||[],"repeater"===n.type)){var o=this.updateRepeater(n.repeater);_.isEqual(n.prevRepeater,this.state.settings.tree_repeater)||this.setState((function(e){return f(f({},e),{},{repeater:o})}))}this.state.settings.select_type!==t.settings.select_type&&this.setState((function(e){return f(f({},e),{},{type:r.state.settings.select_type})}))}}},{key:"handleNodeClick",value:function(e,t){var r=e.isSelected;this.updateNode({node:e,path:t,current:t[0],isSelected:null==r||!r,repeater:this.state.repeater,next:t[1]?t[1]:-1})}},{key:"forEachNode",value:function(e,t){if(void 0!==e){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;t(o),this.forEachNode(o.childNodes,t)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"handleNodeCollapse",value:function(e,t){this.updateNode({node:e,path:t,current:t[0],isExpanded:!1,repeater:this.state.repeater,next:t[1]?t[1]:-1})}},{key:"handleNodeExpand",value:function(e,t){this.updateNode({node:e,path:t,current:t[0],isExpanded:!0,repeater:this.state.repeater,next:t[1]?t[1]:-1})}},{key:"updateNode",value:function(e){var t=this;this.setState((function(r){var n=r.repeater;return e.hasOwnProperty("isExpanded")?w.nodeFromPath(e.path,n).isExpanded=e.isExpanded:(t.forEachNode(n,(function(e){return e.isSelected=!1})),w.nodeFromPath(e.path,n).isSelected=e.isSelected),f(f({},r),{},{repeater:n})}))}},{key:"render",value:function(){return"datasource"!==this.state.type?this.state.repeater.length>0?d.createElement(w,{contents:this.state.repeater,onNodeClick:this.handleNodeClick,onNodeCollapse:this.handleNodeCollapse,onNodeExpand:this.handleNodeExpand}):d.createElement(u.S,null,"Add a branch"):this.state.repeater.length>0?d.createElement(w,{contents:this.state.repeater,onNodeClick:this.handleNodeClick,onNodeCollapse:this.handleNodeCollapse,onNodeExpand:this.handleNodeExpand}):d.createElement(u.S,null,"Datasource is null")}}]),h}(Component);t.default=R},88425:function(e,t,r){"use strict";r.d(t,{Z:function(){return s},S:function(){return l}});var n,o=r(32465),i=r(32360),a=r(71893);function s(e,t){return(0,i.styledString)(["bp3-tree-node svg",["width","icon_size","slider"],["height","icon_size","slider"],"}","bp3-tree-node.bp3-tree-node-selected path",["fill","icon_fill","color",".active"],["stroke","icon_stroke","color",".active"],"}","bp3-tree-node path",["fill","icon_fill","color"],["stroke","icon_stroke","color"],"}","bp3-tree-node path",["fill","icon_fill","color"],["stroke","icon_stroke","color"],"}","bp3-tree-node-label",["","typographic","typographic"],["color","typographic_color","color"],"}","bp3-tree-node-selected .bp3-tree-node-label",["","typographic","typographic",".active"],["color","typographic_color","color",".active"],"}","bp3-tree-node-content",["height","item_height","slider"],["background-color","item_background","color"],["border-radius","border_radius","dimensions"],["","border_shadow","shadow"],["border-style","border_type",""],["border-width","border_width","dimensions"],["border-color","border_color","color"],"}","bp3-tree-node-content:hover",["background-color","item_background","color"],"}","bp3-tree-node-content:hover.bp3-tree-node-content:hover",["background-color","item_background","color",":hover"],["border-radius","border_radius","dimensions",":hover"],["border-style","border_type","",":hover"],["border-width","border_width","dimensions",":hover"],["border-color","border_color","color",":hover"],["","border_shadow","shadow",":hover"],"}","bp3-tree-node-selected > .bp3-tree-node-content:nth-child(1).bp3-tree-node-content, .bp3-tree-node-selected > .bp3-tree-node-content:nth-child(1):hover.bp3-tree-node-content:hover",["background-color","item_background","color",".active"],["border-radius","border_radius","dimensions",".active"],["border-style","border_type","",".active"],["border-width","border_width","dimensions",".active"],["border-color","border_color","color",".active"],["","border_shadow","shadow",".active"],"}"],e,{settingsPrefix:t})}r(76593),r(1866);var l=a.ZP.div(n||(n=(0,o.Z)(["\n  height: 75px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #C4C4C4;\n"])))}}]);
//# sourceMappingURL=TreeWidget.d2c93a89c54b4033c812.bundle.js.map