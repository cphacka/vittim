(self.webpackChunk=self.webpackChunk||[]).push([[7460],{10895:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});var n=r(90484),a=r(92137),o=r(87757),c=r.n(o),l=r(9669),i=r.n(l),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e).reduce((function(t,r,n){return[t,0===n?"?":"&",r=encodeURIComponent(r),"=",encodeURIComponent(e[r])].join("")}),"");return console.log("RESULT ==>",t),t},s=function(){var e=(0,a.Z)(c().mark((function e(t,r){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="","object"===(0,n.Z)(r)?a=u(r):void 0!==r&&(a=u(JSON.parse(r))),e.prev=2,e.next=5,i()(t+a,{});case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",{status:500});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,r){return e.apply(this,arguments)}}()},26568:function(e,t,r){"use strict";var n=r(92137),a=r(28481),o=r(87757),c=r.n(o),l=r(67294),i=r(24549),u=r(65056),s=r(5367),d=r(23233),p=r(10895),m=r(30381),f=r.n(m),v=r(45250);v.Z;var g=_.find(d.Z,{value:"regagro"}).colors,b=_.find(d.Z,{value:"milk"}).colors,h=_.find(d.Z,{value:"milk2"}).colors,y="%d.%m.%Y";t.Z=function(e){var t=e.widget,r=e.width,o=void 0===r?"300px":r,d=e.height,m=void 0===d?"450px":d,O=e.margin,E=e.keyIsDate,k=e.dataSource,w=void 0===k?[]:k,Z=e.lineWidth,j=void 0===Z?2:Z,x=e.pointSize,P=void 0===x?10:x,D=e.xScaleType,S=void 0===D?"point":D,C=e.precision,N=void 0===C?"month":C,M=e.colorScheme,I=void 0===M?"red_grey":M,Y=e.curve,R=void 0===Y?"linear":Y,T=e.enableArea,W=void 0!==T&&T,q=e.enablePoints,L=void 0===q||q,B=e.pointColor,G=(e.yMarker,e.yMarkerValue,e.yMarkerOrientation,e.yMarkerColor,e.yMarkerLabel,e.yMarkerWidth,e.xMarker,e.xMarkerValue,e.xMarkerOrientation,e.xMarkerColor,e.xMarkerLabel,e.xMarkerWidth,e.yMarkerLabelColor,e.xMarkerLabelColor,e.sort),F=void 0===G?"":G,A=e.tickRotation,V=void 0===A?0:A,J=e.bottomAxis,z=void 0===J||J,H=e.enableGridX,X=void 0===H||H,U=e.enableGridY,K=void 0===U||U,$=e.customColorSchemeChecker,Q=void 0!==$&&$,ee=e.customColors,te=void 0===ee?[]:ee,re=e.constantsAxises,ne=void 0===re?[]:re,ae=e.yScaleMax,oe=e.widgetID,ce=e.useCustomTooltips,le=(0,l.useState)(!1),ie=(0,a.Z)(le,2),ue=ie[0],se=ie[1],de=(0,l.useState)([]),pe=(0,a.Z)(de,2),me=pe[0],fe=pe[1],ve=(0,l.useCallback)((0,n.Z)(c().mark((function e(){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(se(!0),0!=w.length){e.next=8;break}return e.next=4,(0,p.O)(t.source,t.filter);case 4:200===(r=e.sent).status&&(n=r.data.data.map((function(e){var t=e.key,r=f()(t).isValid()?f()(t).format("DD.MM.YYYY"):t;return{y:Number(e.data),x:E?r:t}})),fe([{id:"",data:n}]||[]),se(!1)),e.next=19;break;case 8:if(null===F||"undefined"===F||void 0===w){e.next=17;break}e.t0=F,e.next="value"===e.t0?12:"key"===e.t0?14:16;break;case 12:return w.forEach((function(e,t){e.data.length>0&&(w[t].data=_.sortBy(e.data,["y"]))})),e.abrupt("break",17);case 14:return me.forEach((function(e,t){e.data.length>0&&(w[t].data=_.sortBy(e.data,["x"]))})),e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:fe(w||[]),se(!1);case 19:case"end":return e.stop()}}),e)}))),[t]);return(0,l.useEffect)((function(){ve()}),[ve]),ue?l.createElement(u.Z,null):_.uniq(me.map((function(e){return e.data.length>0}))).includes(!0)?l.createElement(l.Fragment,null,l.createElement("div",{style:{width:o,height:m}},l.createElement(i.fH,{data:me,margin:{top:(null==O?void 0:O.top)||30,right:(null==O?void 0:O.right)||30,bottom:(null==O?void 0:O.bottom)||30,left:(null==O?void 0:O.left)||30},xFormat:"time"===S&&"time:%d.%m.%Y",yScale:ae?{max:ae,type:"linear"}:{type:"linear"},xScale:"time"===S?{type:S,format:y,precision:N}:{type:S},lineWidth:j,markers:ne,enableGridX:X,enableGridY:K,axisBottom:z&&("time"===S?{format:y,tickRotation:V}:{tickRotation:V}),useMesh:!0,enableArea:W,enablePoints:L,tooltip:function(e){return console.log("===================================="),console.log(e),console.log("===================================="),l.createElement(v.Z,{keyIsDate:E,datum:e,enable:ce,widgetID:oe})},pointSize:P,curve:R,colors:Q&&te.length>0?te:"regagro"===I?g:"milk"===I?b:"milk2"===I?h:{scheme:I},pointColor:null!=B?B.colorPickedHex:{from:"color",modifiers:[]}}))):l.createElement(s.Z,null)}},78478:function(e,t,r){"use strict";var n=r(22122),a=r(96156),o=r(92137),c=r(28481),l=r(87757),i=r.n(l),u=r(67294),s=r(73445),d=r(65056),p=r(5367),m=r(23233),f=r(10895),v=r(30381),g=r.n(v),b=r(59073),h=r(33695);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=_.find(m.Z,{value:"regagro"}).colors,k=_.find(m.Z,{value:"milk"}).colors,w=_.find(m.Z,{value:"milk2"}).colors,Z=function(e){var t=e.dataWithArc,r=e.centerX,n=e.centerY,a=0;return t.forEach((function(e){a+=e.value})),u.createElement("svg",null,u.createElement("text",{x:r,y:n,textAnchor:"middle",dominantBaseline:"central",className:"centered-metric"},a))};t.Z=function(e){var t=e.widget,r=e.width,a=void 0===r?"300px":r,l=e.height,m=void 0===l?"450px":l,v=e.dataSource,y=void 0===v?[]:v,j=e.colorScheme,x=void 0===j?"red_grey":j,P=e.enableSliceLabels,D=void 0!==P&&P,S=e.innerRadius,C=void 0===S?0:S,N=e.padAngle,M=void 0===N?0:N,I=e.cornerRadius,Y=void 0===I?0:I,R=e.sortByValue,T=void 0===R?0:R,W=e.enableRadialLabels,q=void 0===W||W,L=e.sort,B=void 0===L?"":L,G=e.tickRotation,F=void 0===G?0:G,A=e.bottomAxis,V=void 0===A||A,J=e.keyIsDate,z=void 0!==J&&J,H=e.customColorSchemeChecker,X=void 0!==H&&H,U=e.customColors,K=void 0===U?[]:U,$=e.widgetID,Q=e.useCustomTooltips,ee=e.margin,te=e.title,re=e.subTitle,ne=e.legend,ae=e.activeOuterRadiusOffset,oe=e.activeInnerRadiusOffset,ce=e.useCenteredMetric,le=e.useLinkArcLabels,ie=e.useProcent;ne&&Object.keys(ne).forEach((function(e){return void 0===ne[e]&&delete ne[e]}));var ue=0;y.forEach((function(e){return ue+=e.value}));var se=(0,u.useState)(!1),de=(0,c.Z)(se,2),pe=de[0],me=de[1],fe=(0,u.useState)([]),ve=(0,c.Z)(fe,2),ge=ve[0],be=ve[1],he=(0,u.useCallback)((0,o.Z)(i().mark((function e(){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(me(!0),0!=y.length){e.next=8;break}return e.next=4,(0,f.O)(t.source,t.filter);case 4:200===(r=e.sent).status&&(n=r.data.data.map((function(e){var t=e.key,r=g()(t).isValid()?g()(t).format("DD.MM.YYYY"):t;return{value:Number(e.data),id:z?r:t}})),be(n||[]),me(!1)),e.next=20;break;case 8:if(null===B||"undefined"===B||void 0===y){e.next=18;break}e.t0=B,e.next="value"===e.t0?12:"key"===e.t0?14:16;break;case 12:return y=_.sortBy(y,["value"]),e.abrupt("break",18);case 14:return y=_.sortBy(y,["id"]),e.abrupt("break",18);case 16:return y=y,e.abrupt("break",18);case 18:be(y||[]),me(!1);case 20:case"end":return e.stop()}}),e)}))),[t]);(0,u.useEffect)((function(){he()}),[he]);var ye=["arcs","arcLabels","arcLinkLabels","legends"];ce&&ye.push(Z);var Oe={};return le||(Oe.arcLinkLabelComponent=function(){return u.createElement("text",null)}),pe?u.createElement(d.Z,null):ge&&0!==ge.length?u.createElement(u.Fragment,null,te&&u.createElement("h3",{className:"diagram-title",style:{margin:0}},te),re&&u.createElement("h5",{className:"diagram-subtitle",style:{margin:0}},re),u.createElement("div",{className:"diagram",style:{height:m,width:a}},u.createElement(s.Y2,(0,n.Z)({data:ge,colors:X&&K.length>0?K:"regagro"===x?E:"milk"===x?k:"milk2"===x?w:{scheme:x},tooltip:function(e){return u.createElement(h.Z,{enable:Q,datum:e,data:ge,widgetID:$})},cornerRadius:Y,sortByValue:T,axisBottom:V&&{tickRotation:F},margin:ee,enableRadialLabels:q,legends:ne&&[O({anchor:"top-right",direction:"column",translateX:0,translateY:0,itemsSpacing:2,itemWidth:60,itemHeight:14,itemDirection:"left-to-right",itemOpacity:1,symbolSize:14,symbolShape:"circle"},ne)],innerRadius:C,enableSliceLabels:D,padAngle:M,animate:!0,activeOuterRadiusOffset:ae,activeInnerRadiusOffset:oe,layers:ye,arcLabelsComponent:function(e){var t=e.datum,r=e.label,n=e.style;return console.log({datum:t}),u.createElement(b.q.g,{transform:n.transform,style:{pointerEvents:"none"}},u.createElement("text",{textAnchor:"middle",dominantBaseline:"central",className:"arc-label"},r," ",ie?" (".concat(Math.round(r/ue*100),"%)"):""))}},Oe)))):u.createElement(p.Z,null)}},57167:function(e,t,r){"use strict";var n=r(96156),a=r(92137),o=r(28481),c=r(87757),l=r.n(c),i=r(67294),u=r(33125),s=r(23233),d=r(5367),p=r(10895),m=r(64367),f=r(36968),v=r(59533),g=r(30381),b=r.n(g),h=_.find(s.Z,{value:"regagro"}).colors,y=_.find(s.Z,{value:"milk"}).colors,O=_.find(s.Z,{value:"milk2"}).colors,E="%d.%m.%Y";t.Z=function(e){var t=e.widget,r=e.width,c=void 0===r?"300px":r,s=e.height,g=void 0===s?"450px":s,k=e.dataSource,w=void 0===k?[]:k,Z=e.xScaleType,j=void 0===Z?"point":Z,x=e.colorScheme,P=void 0===x?"red_grey":x,D=e.nodeSize,S=void 0===D?6:D,C=e.sort,N=void 0===C?"":C,M=e.tickRotation,I=void 0===M?0:M,Y=e.bottomAxis,R=void 0===Y||Y,T=e.precision,W=e.enableGridX,q=void 0===W||W,L=e.enableGridY,B=void 0===L||L,G=e.keyIsDate,F=void 0!==G&&G,A=e.customColorSchemeChecker,V=void 0!==A&&A,J=e.customColors,z=void 0===J?[]:J,H=e.constantsAxises,X=void 0===H?[]:H,U=e.yScaleMax,K=e.widgetID,$=e.useCustomTooltips,Q=e.margin,ee=(0,i.useState)(!1),te=(0,o.Z)(ee,2),re=te[0],ne=te[1],ae=(0,i.useState)([]),oe=(0,o.Z)(ae,2),ce=oe[0],le=oe[1],ie=(m.YO[0],(0,i.useCallback)((0,a.Z)(l().mark((function e(){var r,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ne(!0),0!=w.length){e.next=8;break}return e.next=4,(0,p.O)(t.source,t.filter);case 4:200===(r=e.sent).status&&"string"!=typeof r.data&&(n=r.data.data.map((function(e){var t=e.key,r=b()(t).isValid()?b()(t).format("DD.MM.YYYY"):t;return{y:Number(e.data),x:F?r:t}})),le([{id:"",data:n}]),ne(!1)),e.next=19;break;case 8:if(null===N||"undefined"===N||void 0===w){e.next=17;break}e.t0=N,e.next="value"===e.t0?12:"key"===e.t0?14:16;break;case 12:return w.forEach((function(e,t){e.data.length>0&&(w[t].data=_.sortBy(e.data,["y"]))})),e.abrupt("break",17);case 14:return ce.forEach((function(e,t){e.data.length>0&&(w[t].data=_.sortBy(e.data,["x"]))})),e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:le(w||[]),ne(!1);case 19:case"end":return e.stop()}}),e)}))),[t]));return(0,i.useEffect)((function(){ie()}),[ie]),re?i.createElement(f.Z,null):_.uniq(ce.map((function(e){return e.data.length>0}))).includes(!0)?i.createElement(i.Fragment,null,i.createElement("div",{style:{width:c,height:g}},i.createElement(u.IG,(0,n.Z)({data:ce,colors:V&&z.length>0?z:"regagro"===P?h:"milk"===P?y:"milk2"===P?O:{scheme:P},yScale:U?{max:U,type:"linear"}:{type:"linear"},markers:X,margin:{top:(null==Q?void 0:Q.top)||30,right:(null==Q?void 0:Q.right)||30,bottom:(null==Q?void 0:Q.bottom)||30,left:(null==Q?void 0:Q.left)||30},xFormat:"time"===j&&"time:%d.%m.%Y",nodeSize:S,xScale:"time"===j?{type:j,format:E,precision:T}:{type:j},tooltip:function(e){return i.createElement(v.Z,{datum:e,enable:$,widgetID:K})},enableGridX:q,enableGridY:B,axisBottom:R&&("time"===j?{format:E,tickRotation:I}:{tickRotation:I})},"colors",V&&z.length>0?z:"regagro"===P?h:"milk"===P?y:"milk2"===P?O:{scheme:P})))):i.createElement(d.Z,null)}},5367:function(e,t,r){"use strict";var n=r(67294);t.Z=function(e){var t=e.text;return n.createElement("div",{className:"spinner-container"},n.createElement("div",{className:"spinner-container__text"},t||"Данные обрабатываются"))}},65056:function(e,t,r){"use strict";var n=r(67294);t.Z=function(){return n.createElement("div",{className:"spinner-container"},n.createElement("div",{className:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},n.createElement("span",{className:"sr-only"},"Загрузка...")))}},23101:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Te}});var n=r(85061),a=r(96156),o=r(92137),c=r(28481),l=r(87757),i=r.n(l),u=r(67294),s=r(77579),d=r(42564),p=r(9198),m=r.n(p),f=r(30734),v=r(9669),g=r.n(v),b=r(28523),h=r(13981),y=r(548),O=r(80864),E=r(35005),k=r(64367),w=r(65056),Z=r(5367),j=r(23233),x=r(58965),P=r(10895),D=r(22683),S=_.find(j.Z,{value:"regagro"}).colors,C=_.find(j.Z,{value:"milk"}).colors,N=_.find(j.Z,{value:"milk2"}).colors,M=function(e){var t=e.widget,r=(e.width,e.height),n=void 0===r?450:r,l=e.dataSource,s=void 0===l?[]:l,d=e.groupMode,p=void 0===d?"stacked":d,m=e.layout,f=void 0===m?"vertical":m,v=e.colorScheme,g=void 0===v?"regagro":v,b=e.reverse,h=void 0!==b&&b,y=e.enableLabel,O=void 0!==y&&y,E=e.padding,k=void 0===E?.1:E,j=e.innerPadding,M=void 0===j?0:j,I=e.borderRadius,Y=void 0===I?0:I,R=e.borderWidth,T=void 0===R?0:R,W=e.sort,q=void 0===W?"":W,L=e.tickRotation,B=void 0===L?0:L,G=e.bottomAxis,F=void 0===G||G,A=e.enableGridX,V=void 0===A||A,J=e.enableGridY,z=void 0===J||J,H=e.customColorSchemeChecker,X=void 0!==H&&H,U=e.customColors,K=void 0===U?[]:U,$=(e.yScaleMax,e.widgetID),Q=e.useCustomTooltips,ee=(0,u.useState)(!1),te=(0,c.Z)(ee,2),re=te[0],ne=te[1],ae=(0,u.useState)([]),oe=(0,c.Z)(ae,2),ce=oe[0],le=oe[1],ie=(0,u.useCallback)((0,o.Z)(i().mark((function e(){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ne(!0),0!=s.length){e.next=8;break}return e.next=4,(0,P.O)(t.source,t.filter);case 4:200===(r=e.sent).status&&(n=r.data.data.map((function(e,t){var r;return r={},(0,a.Z)(r,e.key,Number(e.data)),(0,a.Z)(r,"key",e.key),(0,a.Z)(r,"value",Number(e.data)),r})),le(n||[]),ne(!1)),e.next=20;break;case 8:if(null==q||void 0===s){e.next=18;break}e.t0=q,e.next="value"===e.t0?12:"key"===e.t0?14:16;break;case 12:return s=_.sortBy(s,["value"]),e.abrupt("break",18);case 14:return s=_.sortBy(s,["key"]),e.abrupt("break",18);case 16:return s=s,e.abrupt("break",18);case 18:le(s||[]),ne(!1);case 20:case"end":return e.stop()}}),e)}))),[t]);return(0,u.useEffect)((function(){ie()}),[ie]),re?u.createElement(w.Z,null):0===ce.length?u.createElement(Z.Z,null):(console.log("===================================="),console.log(g),console.log("===================================="),u.createElement(u.Fragment,null,u.createElement("div",{style:{height:"".concat(n,"px")}},u.createElement(x.jM,(0,a.Z)({data:ce,margin:{top:30,right:30,bottom:30,left:30},indexBy:"key",colors:X&&K.length>0?K:"regagro"===g?S:"milk"===g?C:"milk2"===g?N:{scheme:g},colorBy:"index",layout:f,axisBottom:F&&{tickRotation:B},tooltip:function(e){return u.createElement(D.Z,{enable:Q,datum:e,widgetID:$})},enableGridX:V,enableGridY:z,enableLabel:O,reverse:h,groupMode:p,padding:k,innerPadding:M,borderRadius:Y,borderWidth:T},"axisBottom",{tickSize:5,tickPadding:5,tickRotation:0,legend:"key",legendOffset:32})))))},I=r(78478),Y=r(26568),R=r(30381),T=r.n(R),W=function(e){var t=e.widget,r=(e.width,e.keyIsDate),n=e.dataSource,a=void 0===n?[]:n,l=e.height,s=void 0===l?450:l,d=e.sort,p=void 0===d?"":d,m=(e.tickRotation,(0,u.useState)([])),f=(0,c.Z)(m,2),v=f[0],g=f[1],b=(0,u.useState)(!1),h=(0,c.Z)(b,2),y=h[0],O=h[1],E=(0,u.useCallback)((0,o.Z)(i().mark((function e(){var n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(!0),0!=a.length){e.next=8;break}return e.next=4,(0,P.O)(t.source,t.filter);case 4:200===(n=e.sent).status&&"string"!=typeof n.data&&(o=n.data.data.map((function(e){var t=e.key,n=T()(t).isValid()?T()(t).format("DD.MM.YYYY"):t;return{y:Number(e.data),x:r?n:t}})),g([{id:"",data:o}]),O(!1)),e.next=19;break;case 8:if(null===p||"undefined"===p||void 0===a){e.next=17;break}e.t0=p,e.next="value"===e.t0?12:"key"===e.t0?14:16;break;case 12:return a.forEach((function(e,t){e.data.length>0&&(a[t].data=_.sortBy(e.data,["y"]))})),e.abrupt("break",17);case 14:return v.forEach((function(e,t){e.data.length>0&&(a[t].data=_.sortBy(e.data,["x"]))})),e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:g(a||[]),O(!1);case 19:case"end":return e.stop()}}),e)}))),[t]),k=(0,u.useMemo)((function(){return v.map((function(e){return e.data.reduce((function(e,t){return e+t.y}),0)})).reduce((function(e,t){return e+t}),0)}),[v]);return(0,u.useEffect)((function(){E()}),[E]),y?u.createElement(w.Z,null):_.uniq(v.map((function(e){return e.data.length>0}))).includes(!0)?u.createElement("div",{className:"widget-table",style:{maxHeight:"".concat(s,"px")}},u.createElement("table",{className:"vertical-table"},u.createElement("tbody",null,v.map((function(e,t){var r=e.data.map((function(e,r){return u.createElement("tr",{key:"".concat(t).concat(r)},u.createElement("td",null,e.x),u.createElement("td",null,e.y))}));return u.createElement(u.Fragment,{key:t},u.createElement("tr",{key:t,style:{textAlign:"center"}},u.createElement("td",{colSpan:2},e.id)),r)})),u.createElement("tr",null,u.createElement("td",null,"ИТОГО"),u.createElement("td",null,k))))):u.createElement(Z.Z,null)},q=r(57167),L=function(e){var t=e.widget,r=e.width,n=void 0===r?350:r,a=e.height,o=void 0===a?450:a;switch(t.type){case k.u3:return u.createElement(M,{width:n,height:o,widget:t,isDashboard:!0});case k.en:return u.createElement(I.Z,{width:n,height:o,widget:t,isDashboard:!0});case k.fq:return u.createElement(Y.Z,{width:n,height:o,widget:t,isDashboard:!0});case k.Fe:return u.createElement(W,{width:n,height:o,widget:t,isDashboard:!0});case k.e_:return u.createElement(q.Z,{width:n,height:o,widget:t,isDashboard:!0});default:return u.createElement(u.Fragment,null)}};function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(e){var t=e.widget,r=e.setWidget,n=e.allowedTypes;return u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,null,"Тип виджета"),u.createElement(y.Z.Control,{as:"select",custom:!0,value:t.type,onChange:function(e){return r(G(G({},t),{},{type:e.target.value}))}},n.map((function(e,t){return u.createElement("option",{key:t,value:e},(0,k.z$)(e))}))))};function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J=function(e){var t,r=e.widget,n=e.setWidget,l=e.param,s=e.changeTitle,d=(0,u.useState)([]),p=(0,c.Z)(d,2),m=p[0],f=p[1],v=(0,u.useState)(!1),b=(0,c.Z)(v,2),h=(b[0],b[1]),O=(0,u.useCallback)(function(){var e=(0,o.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("KOSTYA =>",t),h(!0),e.next=4,g()("/ajax/models/queries/".concat(t.model,"/").concat(t.value));case 4:200===(r=e.sent).status&&(console.log(r.data.data),f(r.data.data),h(!1));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[l]);return(0,u.useEffect)((function(){0===m.length&&O(l)}),[l]),u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,null,l.label),u.createElement(y.Z.Control,{as:"select",custom:!0,value:(null===(t=r.filter)||void 0===t?void 0:t[l.value])||"",onChange:function(e){var t=r.filter[l.value]||{},o=m.find((function(e){return e.value==t})),c=void 0!==o&&o.label;console.log(c,"<---"),n(V(V({},r),{},{filter:V(V({},r.filter),{},(0,a.Z)({},l.value,e.target.value))}));var i=m.find((function(t){return t.value==e.target.value})).label||"";s(" / ".concat(i)," / ".concat(c))},required:!0},u.createElement("option",{value:""},"-"),m.map((function(e){var t=e.value,r=e.label;return u.createElement("option",{key:t,value:t},r)}))))};function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var X=function(e){var t=e.widget,r=e.setWidget;return u.createElement(y.Z.Group,{className:"d-none"},u.createElement(y.Z.Label,null,"Легенда"),u.createElement(y.Z.Control,{as:"select",custom:!0,value:t.options.legend,onChange:function(e){return r(H(H({},t),{},{options:H(H({},t.options),{},{legend:e.target.value})}))},required:!0},u.createElement("option",{value:""},"Не показывать"),u.createElement("option",{value:"horizontal"},"Горизонтальная"),u.createElement("option",{value:"vertical"},"Вертикальная")))};function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $=function(e){var t=e.widget,r=e.setWidget;return u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,null,"Положение легенды"),u.createElement(y.Z.Control,{as:"select",custom:!0,value:t.options.legendPosition,onChange:function(e){return r(K(K({},t),{},{options:K(K({},t.options),{},{legendPosition:e.target.value,legend:"left"==e.target.value||"right"==e.target.value?"vertical":"horizontal"})}))},required:!0},u.createElement("option",{value:"bottom"},"Внизу"),u.createElement("option",{value:"left"},"Слева"),u.createElement("option",{value:"right"},"Справа"),u.createElement("option",{value:"top"},"Сверху")))};function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var te=function(e){var t=e.widget,r=e.setWidget,n=e.sources,a=e.changeTitle;return u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,{className:{"d-none":1===n.length}},n.length>1||0==n.length?"Источник данных":"Источник данных: ".concat(n[0].name)),u.createElement(y.Z.Control,{as:"select",custom:!0,className:{"d-none":1===n.length},value:t.source,onChange:function(e){r(ee(ee({},t),{},{source:e.target.value}));var o=n.find((function(t){return t.url==e.target.value})).label||"";a(" / ".concat(o))},required:!0},u.createElement("option",{value:""},"-"),n.map((function(e){var t=e.url,r=e.name;return u.createElement("option",{key:t,value:t},r)}))))},re=r(50274);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe=function(e){var t=e.widget,r=e.setWidget,a=Object.keys(re.schemes).map((function(e){return{label:e,value:e}}));return a=[].concat((0,n.Z)(a),[{label:"Custom",value:"Custom"}]),u.createElement(y.Z.Group,{className:"d-none"},u.createElement(y.Z.Label,null,"Цветовая схема"),u.createElement(y.Z.Control,{as:"select",custom:!0,value:t.options.colorScheme,onChange:function(e){return r(ae(ae({},t),{},{options:ae(ae({},t.options),{},{colorScheme:e.target.value})}))},required:!0},a.map((function(e){var t=e.label,r=e.value;return u.createElement("option",{key:r,value:r},t)}))))};function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ie=function(e){var t=e.widget,r=e.setWidget;return u.createElement(y.Z.Group,null,u.createElement(y.Z.Check,{type:"checkbox",checked:t.options.isVertical,label:"Вертикальная таблица",onChange:function(e){return r(le(le({},t),{},{options:le(le({},t.options),{},{isVertical:e.target.checked})}))}}))};function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var de=function(e){var t=e.widget,r=e.setWidget;return u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,null,"Сортировка данных"),u.createElement(y.Z.Control,{as:"select",custom:!0,value:t.options.sort||0,onChange:function(e){return r(se(se({},t),{},{options:se(se({},t.options),{},{sort:e.target.value})}))},required:!0},[{label:"Без сортировки",value:0},{label:"По ключу",value:1},{label:"По значению",value:2}].map((function(e){var t=e.label,r=e.value;return u.createElement("option",{key:r,value:r},t)}))))};function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=function(e){var t,r,a,l,s=e.id,d=e.onAdd,p=e.setIsShow,m=e.settings,f=(0,u.useState)({type:k.Fe,source:"",options:{isVertical:!1,legend:"",legendPosition:"bottom",colorScheme:"Custom"},filter:{}}),v=(0,c.Z)(f,2),b=v[0],h=v[1],w=(0,u.useRef)(""),Z=function(){var e=(0,o.Z)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=me(me({},b),{},{title:w.current.value,options:JSON.stringify(b.options),filter:JSON.stringify(b.filter)}),console.log("ON SAVE =>",JSON.stringify(b.options),JSON.stringify(b.filter)),e.next=4,g().post("/ajax/dashboards/".concat(s),t);case 4:200===(r=e.sent).status&&(d(r.data),p(!1));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];w.current.value.includes(t)&&(w.current.value=w.current.value.replace(t,e)),w.current.value.includes(e)||(w.current.value+=e)},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e&&0!==e.length?e.map((function(e){return{name:e.label,url:"/ajax/models/queries/".concat(e.model,"/").concat(e.value)}})):[]};if(1===x(m.sql).length){var P=x(m.sql)[0];b.source=P.url,setTimeout((function(){return j("".concat(P.name))}),0)}return u.createElement(O.Z,null,u.createElement(O.Z.Header,null,u.createElement(O.Z.Title,null,"Добавить виджет")),u.createElement(O.Z.Body,null,u.createElement(y.Z,null,u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,null,"Название виджета"),u.createElement(y.Z.Control,{type:"text",ref:w,onFocus:function(e){"Новый виджет"===e.target.value&&(w.current.value="")},onBlur:function(e){""===e.target.value&&(w.current.value="Новый виджет")},defaultValue:"",required:!0})),u.createElement(te,{widget:b,setWidget:h,sources:x(m.sql),changeTitle:j}),u.createElement(de,{widget:b,setWidget:h}),b.source&&(null===(t=m.filter)||void 0===t?void 0:t.length)>0&&(null===(r=m.filter)||void 0===r?void 0:r.map((function(e){return u.createElement(J,{key:e.value,widget:b,setWidget:h,param:e,changeTitle:j})}))),u.createElement(F,{widget:b,setWidget:h,allowedTypes:[].concat((0,n.Z)(function(e){var t,r,n=e;n=n.includes("?")?n.split("?")[0]:e;var a=null===(t=m.sql)||void 0===t?void 0:t.find((function(e){return n==="/ajax/models/queries/".concat(e.model,"/").concat(e.value)}));return(null==a||null===(r=a.types)||void 0===r?void 0:r.map((function(e){return e.value})))||[]}(b.source)),[k.Fe])}),b.source&&b.type===k.Fe&&u.createElement(ie,{widget:b,setWidget:h}),u.createElement(oe,{widget:b,setWidget:h}),(null===(a=b.options)||void 0===a?void 0:a.legend)&&u.createElement($,{widget:b,setWidget:h})),u.createElement("div",{className:"widget-placeholder altrp-chart ".concat(null===(l=b.options)||void 0===l?void 0:l.legendPosition)},b.source&&u.createElement(L,{widget:b,width:360,height:360}))),u.createElement(O.Z.Footer,null,u.createElement(E.Z,{variant:"secondary",onClick:function(){return p(!1)}},"Закрыть"),u.createElement(E.Z,{variant:"warning",onClick:Z,disabled:""===b.source},"Сохранить")))},ve=r(29306),ge=r.n(ve),be=r(29553),he=r.n(be),ye=r(62876),Oe=r(91657),Ee=r(52653),ke=r(14575);function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var je=function(e){var t,r,a,l=e.data,s=e.onEdited,d=e.setIsEdit,p=e.settings,m=(0,u.useState)(l),f=(0,c.Z)(m,2),v=f[0],g=f[1],b=(0,u.useRef)(v.title),h=function(){var e=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(Ze(Ze({},v),{},{title:b.current.value})),d(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e&&0!==e.length?e.map((function(e){return{name:e.label,url:"/ajax/models/queries/".concat(e.model,"/").concat(e.value)}})):[]},Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b.current.value.includes(t)&&(b.current.value=b.current.value.replace(t,e)),b.current.value.includes(e)||(b.current.value+=e)};if(1===w(p.sql).length){var j=w(p.sql)[0];v.source=j.url}return u.createElement(O.Z,null,u.createElement(O.Z.Header,null),u.createElement(O.Z.Body,null,u.createElement(y.Z,null,u.createElement(y.Z.Group,null,u.createElement(y.Z.Label,null,"Название виджета"),u.createElement(y.Z.Control,{type:"text",ref:b,defaultValue:v.title,required:!0})),u.createElement(te,{widget:v,setWidget:g,sources:w(p.sql),changeTitle:Z}),u.createElement(de,{widget:v,setWidget:g}),v.source&&(null===(t=p.filter)||void 0===t?void 0:t.length)>0&&(null===(r=p.filter)||void 0===r?void 0:r.map((function(e){return u.createElement(J,{key:e.value,widget:v,setWidget:g,param:e,changeTitle:Z})}))),u.createElement(F,{widget:v,setWidget:g,allowedTypes:[].concat((0,n.Z)(function(e){var t,r,n=e;n=n.includes("?")?n.split("?")[0]:e;var a=p&&(null===(t=p.sql)||void 0===t?void 0:t.find((function(e){return n==="/ajax/models/queries/".concat(e.model,"/").concat(e.value)})));return(null==a||null===(r=a.types)||void 0===r?void 0:r.map((function(e){return e.value})))||[]}(v.source)),[k.Fe])}),v.source&&v.type===k.Fe&&u.createElement(ie,{widget:v,setWidget:g}),u.createElement(oe,{widget:v,setWidget:g}),u.createElement(X,{widget:v,setWidget:g}),u.createElement($,{widget:v,setWidget:g})),u.createElement("div",{className:"widget-placeholder altrp-chart ".concat(null===(a=v.options)||void 0===a?void 0:a.legendPosition)},v.source&&u.createElement(L,{widget:v,width:360,height:360}))),u.createElement(O.Z.Footer,null,u.createElement(E.Z,{variant:"secondary",onClick:function(){return d(!1)}},"Закрыть"),u.createElement(E.Z,{variant:"warning",onClick:h,disabled:""===v.source},"Сохранить")))},xe=u.memo(je);r(80147);var Pe=function(e){var t,r=e.widget,n=e.onDeleted,a=e.onEdited,l=e.settings,d=(e.isMobile,(0,u.useState)(!1)),p=(0,c.Z)(d,2),m=p[0],f=p[1],v=(0,u.useRef)(null),g=function(){var e=(0,o.Z)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.current.querySelector(".card-body"),e.next=3,ge().toPng(t);case 3:r=e.sent,(n=document.createElement("a")).download="widget_".concat((new Date).getTime(),".png"),n.href=r,n.click();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u.createElement(O.Z,{key:r.id,ref:v},u.createElement(O.Z.Header,null,u.createElement(O.Z.Title,null,r.title),u.createElement(O.Z.Title,null,u.createElement("div",{className:"dropdownTogglerContainer"},u.createElement(s.Z,{drop:"left"},u.createElement(s.Z.Toggle,{variant:"light"},u.createElement(h.Z,{color:"#7a7a7b"})),u.createElement(s.Z.Menu,{className:"dropdownMenuToggle",style:{zIndex:999999,background:"rgba(255,255,255,1)"}},u.createElement(s.Z.Item,null,u.createElement(he(),{trigger:function(){return u.createElement("button",{type:"button",title:"Распечатать виджет"},u.createElement(Ee.Z,null))},content:function(){return v.current}})),u.createElement(s.Z.Item,null,u.createElement("button",{type:"button",title:"Скачать файл",onClick:g},u.createElement(ke.Z,null))),u.createElement(s.Z.Item,null,u.createElement("button",{type:"button",title:"Настроить виджет",onClick:function(){return f(!m)}},u.createElement(ye.Z,null))),u.createElement(s.Z.Item,null,u.createElement("button",{type:"button",title:"Удалить виджет",onClick:function(){return n(r)}},u.createElement(Oe.Z,null)))))))),u.createElement(O.Z.Body,{className:"altrp-chart ".concat(null===(t=r.options)||void 0===t?void 0:t.legendPosition)},m?u.createElement(xe,{settings:l,data:r,onEdited:a,setIsEdit:f}):u.createElement(L,{widget:r,width:360,height:300})))},De=r(6610),Se=r(5991),Ce=r(10379),Ne=r(46070),Me=r(77608);var Ie=function(e){(0,Ce.Z)(c,e);var t,r,n,a=(r=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,Me.Z)(r);if(n){var a=(0,Me.Z)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,Ne.Z)(this,e)});function c(e){var t;return(0,De.Z)(this,c),(t=a.call(this,e)).state={options:[]},t}return(0,Se.Z)(c,[{key:"componentDidMount",value:(t=(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g()("/ajax/models/queries/".concat(this.props.parameter.model,"/").concat(this.props.parameter.value));case 2:200===(t=e.sent).status?this.setState({options:t.data.data}):this.setState({options:[]});case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return u.createElement(y.Z.Control,{as:"select",className:"global-select",onChange:function(t){e.props.setGlobalOption(e.props.parameter.value,t.target.value),t.preventDefault(),t.stopPropagation()},custom:!0},u.createElement("option",{value:""},this.props.parameter.label),this.state.options.map((function(e,t){var r=e.id,n=e.name,a=e.value,o=e.label;return u.createElement("option",{key:t,value:a||r},o||n)})))}}]),c}(Component);function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r(53524),(0,p.registerLocale)("ru",b.Z),(0,p.setDefaultLocale)("ru");var Te=function(e){var t=e.id,r=e.settings,l=e.globalParameter,p=(new Date).setFullYear((new Date).getFullYear()-1),v=(new Date).getTime(),b=(0,u.useState)([]),y=(0,c.Z)(b,2),O=y[0],E=y[1],k=(0,u.useState)(!1),w=(0,c.Z)(k,2),Z=w[0],j=w[1],x=(0,u.useState)(p),P=(0,c.Z)(x,2),D=P[0],S=P[1],C=(0,u.useState)(v),N=(0,c.Z)(C,2),M=N[0],I=N[1],Y=screen.width<=480,R=function(){var e=(0,o.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()("/ajax/dashboards/".concat(t,"/settings"),{headers:[{key:"Cache-Control",value:"no-store"}]});case 3:if(200!==(r=e.sent).status){e.next=9;break}return console.log("req.data :>> ",r.data),e.abrupt("return",JSON.parse(r.data.settings));case 9:return e.abrupt("return",{});case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",{});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,o.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()("/ajax/dashboards/".concat(t),{headers:[{key:"Cache-Control",value:"no-store"}]});case 3:if(200!==(r=e.sent).status){e.next=9;break}return console.log("req.data DASHBOARDS:>> ",r.data),e.abrupt("return",r.data);case 9:return e.abrupt("return",[]);case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),_=(0,u.useCallback)(function(){var e=(0,o.Z)(i().mark((function e(t,n,a){var o,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T(t);case 3:return o=e.sent,e.next=6,R(t);case 6:null!==(c=e.sent)&&c.hasOwnProperty("startDate")&&c.hasOwnProperty("endDate")?(E(o.map((function(e){return Re(Re({},e),{},{options:Re(Re({},JSON.parse(e.options)),{},{animated:r.animated}),filter:Re(Re({},JSON.parse(e.filter)),c)})}))),S(c.startDate),I(c.endDate)):(E(o.map((function(e){return Re(Re({},e),{},{options:Re(Re({},JSON.parse(e.options)),{},{animated:r.animated}),filter:Re(Re({},JSON.parse(e.filter)),{},{startDate:n,endDate:a})})}))),g().post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:n,endDate:a}},{headers:[{key:"Cache-Control",value:"no-store"}]})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r,n){return e.apply(this,arguments)}}(),[t,r.animated,D,M]),W=function(e){E(O.filter((function(t){return t.id!==e.id}))),g().delete("/ajax/dashboards/".concat(e.id),{headers:[{key:"Cache-Control",value:"no-store"}]})},q=function(e){E(O.map((function(t){return t.id===e.id?e:t}))),g().put("/ajax/dashboards/".concat(e.id),Re(Re({},e),{},{options:JSON.stringify(e.options),filter:JSON.stringify(e.filter)}),{headers:[{key:"Cache-Control",value:"no-store"}]})},L=function(e){S(e.getTime()),g().post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:e.getTime(),endDate:M}},{headers:[{key:"Cache-Control",value:"no-store"}]})},B=function(e){I(e.getTime()),g().post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:D,endDate:e.getTime()}},{headers:[{key:"Cache-Control",value:"no-store"}]})},G=function(){var e=(0,f.Z)(M,{weeks:1}).getTime();S(e),g().post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:e,endDate:M}},{headers:[{key:"Cache-Control",value:"no-store"}]})},F=function(){var e=(0,f.Z)(M,{months:1}).getTime();S(e),g().post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:e,endDate:M}},{headers:[{key:"Cache-Control",value:"no-store"}]})},A=function(e,t){E(O.map((function(r){return Re(Re({},r),{},{filter:Re(Re({},r.filter),{},(0,a.Z)({},e,t))})})))};return(0,u.useEffect)((function(){_(t,D,M)}),[t,D,M]),u.createElement("div",{className:"altrp-dashboard"},u.createElement("div",{className:"altrp-dashboard__controls"},Y?u.createElement(s.Z,null,u.createElement(s.Z.Toggle,{variant:"light"},u.createElement(h.Z,{color:"#7a7a7b"})),u.createElement(s.Z.Menu,null,u.createElement(s.Z.Item,{onClick:function(){return j(!0)}},"Добавить виджет"),u.createElement(s.Z.Divider,null),u.createElement(s.Z.Item,{onClick:G},"Неделя"),u.createElement(s.Z.Item,{onClick:F},"Месяц"),u.createElement(s.Z.Divider,null),u.createElement(s.Z.ItemText,{as:"div"},u.createElement(m(),{closeOnScroll:!0,className:"form-control first",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:D,selectsStart:!0,onChange:L,dateFormat:"dd.MM.yyyy",showYearDropdown:!0})),u.createElement(s.Z.ItemText,{as:"div"},u.createElement(m(),{closeOnScroll:!0,className:"form-control last",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:M,minDate:D,selectsEnd:!0,onChange:B,dateFormat:"dd.MM.yyyy",showYearDropdown:!0})),u.createElement(s.Z.Divider,null),l&&l.map((function(e,t){return u.createElement(s.Z.Item,{onClick:function(e){e.stopPropagation(),e.preventDefault()},key:t},u.createElement(Ie,{settings:r,setGlobalOption:A,parameter:e}))})))):u.createElement(d.Z,{className:"jusitfy-content-end"},u.createElement(d.Z.Item,{className:"nav-button",onClick:function(){return j(!0)}},"Добавить виджет"),u.createElement(d.Z.Item,{className:"nav-datepickers"},u.createElement("div",{className:"nav-datepicker"},u.createElement(m(),{closeOnScroll:!0,className:"form-control first",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:D,selectsStart:!0,onChange:L,dateFormat:"dd.MM.yyyy",showYearDropdown:!0})),u.createElement("div",{className:"nav-datepicker"},u.createElement(m(),{closeOnScroll:!0,className:"form-control last",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:M,minDate:D,selectsEnd:!0,onChange:B,dateFormat:"dd.MM.yyyy",showYearDropdown:!0}))),u.createElement(d.Z.Item,{className:"nav-button",onClick:G},"Неделя"),u.createElement(d.Z.Item,{className:"nav-button",onClick:F},"Месяц"),l&&l.map((function(e,t){return u.createElement(d.Z.Item,{key:t},u.createElement(Ie,{settings:r,setGlobalOption:A,parameter:e}))})))),u.createElement("div",{className:"altrp-dashboard__widgets"},Z&&u.createElement(fe,{settings:r,id:t,setIsShow:j,onAdd:function(e){E([e].concat((0,n.Z)(O)))}}),O.map((function(e){return u.createElement(Pe,{settings:r,key:e.id,widget:e,onDeleted:W,onEdited:q,isMobile:Y})}))))}}}]);
//# sourceMappingURL=AltrpDashboards.60102adb2646a13db88d.bundle.js.map